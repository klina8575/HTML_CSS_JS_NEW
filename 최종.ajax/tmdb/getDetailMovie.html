<!DOCTYPE html>
<html lang="ko">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Document</title>
   </head>
   <body>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
      <script>
         //1. 전체 url가져오기
         const currentURL = location.href

         //2. 쿼리스트링 파라메터 가져오기
         const urlObj = new URL(currentURL)
         const params = urlObj.searchParams

         const id = params.get('id')

         const movieURL = `https://api.themoviedb.org/3/movie/${id}?language=ko-KR`
         $.ajax({
            type: 'GET',
            url: movieURL,
            dataType: 'json',
            beforeSend: function (xhr) {
               xhr.setRequestHeader('accept', 'application/json')
               xhr.setRequestHeader(
                  'Authorization',
                  'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI1ZDI5ZmIzYTNiOGFkZjkzYzNkNTQxNDU4OTczNzA0OSIsInN1YiI6IjYyNGQ0MzQxYzM5MjY2MDA0ZjkyOThiZSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.KZgDPlwHrwsC_3j6fia23GszszY_VDlhbRIblx1jGQc'
               )
            },
            success: function (data) {
               console.log('전체 data:', data)

               let imgURL = 'https://image.tmdb.org/t/p/w500' + data.poster_path

               $('body').append(`<img src="${imgURL}"><br>`)
               $('body').append(`<h2>${data.title}</h2>`)
               $('body').append(`<p>${data.overview}</p>`)
               $('body').append(`<p>평점:${data.vote_average.toFixed(2)}</p>`)
            },
            error: function (request, status, error) {
               console.log('code:' + request.status)
               console.log('message:' + request.responseText)
               console.log('error:' + error)
            },
         })
      </script>
   </body>
</html>
